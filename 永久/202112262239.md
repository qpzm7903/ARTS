#nginx #location

[[202112232203]]
## 路由location

语法
```nginx.conf
location [=|~|~*|^~|@] pattern {...}
```

`[=|~|~*|^~|@]`表示修饰语，定义URI的匹配方式，pattern可以是字符串或者正则

修饰语“=”：完全匹配URI中除访问参数以外的内容，Linux系统下会区分大小写，Windows系统下则不会。

修饰语“~”：完全匹配URI中除访问参数以外的内容，Linux系统下会区分大小写，Windows系统下则会无效。匹配项的内容必须是正则表达式。

修饰语“~*”：完全匹配URI中除访问参数以外的内容，不区分大小写。匹配项的内容必须是正则表达式。

修饰语“^~”：完全匹配URI中除访问参数以外的内容，匹配项的内容如果不是正则表达式，则不再进行正则表达式测试。

修饰语“@”：定义一个只能内部访问的location区域，可以被其他内部跳转指令使用，如try_files或error_page。

### localtion匹配顺序
- 先非正则，再正则
- 如果两个都匹配，则用正则
- 如果非正则的都匹配，按匹配最多的进行执行
- 如果都是正则的匹配到，按照先后顺序

### 例子
https://docs.nginx.com/nginx/admin-guide/web-server/web-server/

```nginx
server {
    location /images/ {
        root /data;
    }

    location / {
        proxy_pass http://www.example.com;
    }
}
```

> The [root](https://nginx.org/en/docs/http/ngx_http_core_module.html#root) directive specifies the file system path in which to search for the static files to serve. The request URI associated with the location is appended to the path to obtain the full name of the static file to serve. In the example above, in response to a request for **/images/example.png**, NGINX Plus delivers the file **/data/images/example.png**.

也就是当uri以/images开头的时候，nginx就会把请求uri拼上root去文件系统中寻找

如果不匹配/images，那么就会把请求转发到代理去。