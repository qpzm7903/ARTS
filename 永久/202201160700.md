#docker #volume

# 持久化

docker中使用volume来做持久化。将宿主机上的目录于容器里的目录进行映射，则容器对此目录的读写，都会映射到宿主机上的目录上。这个宿主机上映射的目录称为卷（volume）。

## volume 
是docker的一等公民（有自己命令的）

```
shell

  % docker volume --hlep      
unknown flag: --hlep
See 'docker volume --help'.

Usage:  docker volume COMMAND

Manage volumes

Commands:
  create      Create a volume
  inspect     Display detailed information on one or more volumes
  ls          List volumes
  prune       Remove all unused local volumes
  rm          Remove one or more volumes

Run 'docker volume COMMAND --help' for more information on a command.

```


支持持久化的格式
- 块存储
- 文件存储
- 对象存储


怎么在容器中使用volume
创建容器的时候将volume挂载到容器的目录里，相当于linux的挂载一样
```shell
docker container run -dit --name testVolume --mount source=newVolume,target=/vol ubuntu
```

疑问：我在windows装的docker，但是却访问不到创建的volume。
```ps
PS C:\Users\qpzm7903> docker volume inspect w10
[
    {
        "CreatedAt": "2022-01-16T06:59:54Z",
        "Driver": "local",
        "Labels": {},
        "Mountpoint": "/var/lib/docker/volumes/w10/_data",
        "Name": "w10",
        "Options": {},
        "Scope": "local"
    }
]
PS C:\Users\qpzm7903> ls /var/lib/docker/volumes/w10/_data
ls : 找不到路径“C:\var\lib\docker\volumes\w10\_data”，因为该路径不存在。
所在位置 行:1 字符: 1
+ ls /var/lib/docker/volumes/w10/_data
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\var\lib\docker\volumes\w10\_data:String) [Get-C
   hildItem], ItemNotFoundException
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetChildItemCommand
    + 
```

不管是在wi10还是在wsl子系统里面。

google搜索到结果：https://blog.csdn.net/u013568383/article/details/113888776

在powershell里面输入wsl -l -v的是时候会输出
```powershell
PS C:\Users\qpzm7903> wsl -l -v
  NAME                   STATE           VERSION
* Ubuntu-20.04           Running         2
  docker-desktop-data    Running         2
  docker-desktop         Running         2
```
docker-desktop存放镜像
docker-desktop-data存放容器，数据卷应该也是一种容器，所以也是在data里面。

可以通过浏览器访问到。
`file://wsl%24/docker-desktop-data/`，在根据docker volume inspect的结果去找
	比如`/var/lib/docker/volumes/newVolume/_data`
则访问路径是
`file://wsl%24/docker-desktop-data/version-pack-data/community/docker/volumes/newVolume/`



