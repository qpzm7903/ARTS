# flyway and h2
#flyway
#h2
flayway 管理数据库脚本
h2 内存数据库，用于验证

环境 spring + h2 + jpa

依赖如下

```xml
    <dependencies>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-jpa</artifactId>
        </dependency>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>

        <dependency>
            <groupId>com.h2database</groupId>
            <artifactId>h2</artifactId>
            <scope>runtime</scope>
        </dependency>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>org.flywaydb</groupId>
            <artifactId>flyway-core</artifactId>
            <version>8.5.10</version>
        </dependency>


    </dependencies>


```

配置
```properties
spring.datasource.url=jdbc:h2:mem:testdb  
spring.datasource.driverClassName=org.h2.Driver  
spring.datasource.username=sa  
spring.datasource.password=password  
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect  
spring.h2.console.enabled=true  
  
spring.flyway.user=sa  
spring.flyway.password=password  
spring.flyway.schemas=testdb  
spring.flyway.url=jdbc:h2:mem:testdb  
spring.flyway.locations=classpath:db/migration  
  
logging.level.org.flywaydb=debug
```

连接
localhost:8080/h2-console
![[Pasted image 20220510212229.png]]


资源目录下创建db/migration

V001__init.sql
```sql
CREATE TABLE IF NOT EXISTS `employee`  
(  
  
    `id`            int NOT NULL AUTO_INCREMENT PRIMARY KEY,  
    `name`          varchar(20),  
    `email`         varchar(50),  
    `date_of_birth` timestamp  
  
);
```

V002__alter.sql
```sql
alter table if exists `employee` alter column if exists name rename to nameEn;
```

进入h2控制面板观察
	![[Pasted image 20220510214803.png]]



# spring boot 会加载哪些上下文文件
#spring
#spring-boot



# spring boot 会加载哪些配置文件
#spring #spring-boot 



# spring properties 
[相关配置](https://docs.spring.io/spring-boot/docs/current/reference/html/application-properties.html#appendix.application-properties.core)
