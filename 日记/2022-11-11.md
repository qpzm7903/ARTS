
# JVM OOM 定位
#jvm #OOM

```java
/**  
 * VM args: -Xms20m -Xmx20m -XX:+HeapDumpOnOutOfMemoryError * @author qpzm7903  
 * @since 2022-11-11-22:54  
 */public class HeapOOM {  
    static class OOMObject{  
  
    }  
    public static void main(String[] args) {  
        List<OOMObject> list = new ArrayList<>();  
        while (true) {  
            list.add(new OOMObject());  
        }  
    }  
}
```

执行后就会得到一个![[java_pid20080.hprof]]文件。
使用各种工具打开他，可以看到哪个对象超过了。

各个自动转储的参数：在 Advanced Serviceability Options里

>  -XX:+HeapDumpOnOutOfMemory
           Enables the dumping of the Java heap to a file in the current directory by using the
           heap profiler (HPROF) when a java.lang.OutOfMemoryError exception is thrown. You can
           explicitly set the heap dump file path and name using the -XX:HeapDumpPath option. By
           default, this option is disabled and the heap is not dumped when an OutOfMemoryError
           exception is thrown.
	   

需要读man java